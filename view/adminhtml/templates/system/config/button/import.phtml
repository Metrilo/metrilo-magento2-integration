<?php
/**
 * @var $block \Metrilo\Analytics\Block\System\Config\Button\Import
 * @var \Magento\Framework\Escaper $escaper
 */
?>
<?php if ($block->buttonEnabled()): ?>
    <?php
        $storeId = $block->getStoreId();
    ?>
    <div class="pp-buttons-container">
        <button id="<?= $block->getHtmlId() ?>" onclick="return false;">
            <span><?= $escaper->escapeHtml(__('Import')) ?></span>
        </button>
    </div>
    <script>
    require([
        'jquery',
        'metriloImport'
    ], function($, metrilo) {
        $("#<?= $escaper->escapeJs($block->getHtmlId()) ?>").import({
            storeId: <?= $escaper->escapeJs($storeId); ?>,
            customersChunks: <?= $escaper->escapeJs($block->getCustomerChunks()) ?>,
            categoriesChunks: <?= $escaper->escapeJs($block->getCategoryChunks()) ?>,
            productsChunks: <?= $escaper->escapeJs($block->getProductChunks()) ?>,
            ordersChunks: <?= $escaper->escapeJs($block->getOrderChunks()) ?>,
            submitUrl: '<?= $escaper->escapeUrl($block->getAjaxUrl()) ?>',
            messageSelector: '#metrilo_import_status'
        });
    });
    </script>
    <div id="metrilo_import_status"></div>
<?php endif; ?>
